class Solution {
    public long splitArray(int[] nums) {
        int n = nums.length;
        if (n < 2) return -1;
        long[] prefix = new long[n + 1];
        for (int i = 0; i < n; i++) {
            prefix[i + 1] = prefix[i] + nums[i];
        }
        boolean[] leftValid = new boolean[n];
        leftValid[0] = true;
        for (int i = 1; i < n; i++) {
            leftValid[i] = leftValid[i - 1] && (nums[i] > nums[i - 1]);
        }
        
        boolean[] rightValid = new boolean[n];
        rightValid[n - 1] = true;
        for (int i = n - 2; i >= 0; i--) {
            rightValid[i] = rightValid[i + 1] && (nums[i] > nums[i + 1]);
        }
        
        long minDiff = Long.MAX_VALUE;
        boolean found = false;
       
        for (int i = 0; i < n - 1; i++) {
            if (!leftValid[i]) continue;
            if (i + 1 < n - 1 && !rightValid[i + 1]) continue;
            
            long leftSum = prefix[i + 1];
            long rightSum = prefix[n] - prefix[i + 1];
            long diff = Math.abs(leftSum - rightSum);
            
            minDiff = Math.min(minDiff, diff);
            found = true;
        }
        
        return found ? minDiff : -1;
    }
}